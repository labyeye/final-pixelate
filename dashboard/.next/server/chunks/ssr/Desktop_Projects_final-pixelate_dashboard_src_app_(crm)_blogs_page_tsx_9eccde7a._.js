module.exports=[50705,a=>{"use strict";var b=a.i(57457),c=a.i(90782),d=a.i(90537),e=a.i(73647);function f(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=localStorage.getItem("pn_posts");if(a)try{f(JSON.parse(a))}catch(a){}(async()=>{try{let a=await fetch("/api/blogs");if(a.ok){let b=await a.json();t(Array.isArray(b)?b:[])}}catch(a){}})()},[]);let{user:u}=(0,d.useAuth)(),v=u?.role==="admin";function w(a){localStorage.setItem("pn_posts",JSON.stringify(a))}async function x(){if(!g)return alert("title required");let b={id:Date.now(),title:g,category:i,excerpt:k,content:m,image:o,createdAt:new Date().toISOString()},c="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"";try{let d=await fetch(c+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(d.ok){let c=await d.json(),e=[{...b,...c},...a];f(e),w(e),h(""),j(""),l(""),n(""),p("");return}}catch(a){}let d=[b,...a];f(d),w(d),h(""),j(""),l(""),n(""),p(""),alert("Saved locally (server unreachable).")}async function y(){let b=localStorage.getItem("pn_posts");if(!b)return alert("No local posts found");let c=[];try{c=JSON.parse(b)}catch(a){return alert("Invalid local posts JSON")}if(!c.length)return alert("No local posts to publish");let d="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"",e=[...a];for(let a of c)try{let b=await fetch(d+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(b.ok){let c=await b.json();e.unshift({...a,...c})}else e.unshift(a)}catch(b){e.unshift(a)}f(e),w(e),alert("Publish attempt finished. Check public site or API to confirm.")}async function z(){let b;if(!q)return alert("Paste JSON into the import box first");try{b=JSON.parse(q)}catch(a){return alert("Invalid JSON")}let c=Array.isArray(b)?b:[b],d="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"",e=[...a];for(let a of c)try{let b=await fetch(d+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(b.ok){let c=await b.json();e.unshift({...a,...c})}else e.unshift(a)}catch(b){e.unshift(a)}f(e),w(e),r(""),alert("Import finished. Check public site or API to confirm.")}return(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Blogs Management"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("input",{value:g,onChange:a=>h(a.target.value),placeholder:"Title",className:"w-full p-3 rounded-md bg-background border"})}),(0,b.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[(0,b.jsx)("input",{value:i,onChange:a=>j(a.target.value),placeholder:"Category",className:"p-3 rounded-md bg-background border"}),(0,b.jsx)("input",{type:"file",onChange:function(a){let b=a.target.files&&a.target.files[0];if(!b)return;let c=new FileReader;c.onload=()=>p(String(c.result)),c.readAsDataURL(b)},className:"p-3 rounded-md bg-background border"})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("textarea",{value:k,onChange:a=>l(a.target.value),placeholder:"Excerpt",className:"w-full p-3 rounded-md bg-background border",rows:3})}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("textarea",{value:m,onChange:a=>n(a.target.value),placeholder:"Content (HTML allowed)",className:"w-full p-3 rounded-md bg-background border",rows:8})}),(0,b.jsx)("div",{className:"flex gap-3",children:(0,b.jsx)(e.Button,{onClick:x,children:"Add Post"})})]}),(0,b.jsxs)("aside",{className:"p-4 bg-muted rounded-md",children:[(0,b.jsx)("h3",{className:"font-bold mb-2",children:"Preview"}),o?(0,b.jsx)("img",{src:o,alt:"preview",className:"w-full mb-2"}):(0,b.jsx)("div",{className:"mb-2 text-sm text-muted",children:"No image"}),(0,b.jsx)("div",{className:"font-bold",children:g||"Title goes here"}),(0,b.jsx)("div",{className:"text-sm text-muted mb-2",children:i}),(0,b.jsx)("div",{className:"text-sm",children:k})]})]}),(0,b.jsxs)("div",{className:"mt-8",children:[(0,b.jsx)("h3",{className:"font-bold mb-2",children:"Existing Posts"}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold mb-2",children:"Server posts"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-left",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-2 py-1",children:"Title"}),(0,b.jsx)("th",{className:"px-2 py-1",children:"Category"}),(0,b.jsx)("th",{className:"px-2 py-1",children:"Created"}),(0,b.jsx)("th",{className:"px-2 py-1",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:s.map(a=>(0,b.jsxs)("tr",{className:"border-t",children:[(0,b.jsx)("td",{className:"px-2 py-2",children:a.title}),(0,b.jsx)("td",{className:"px-2 py-2",children:a.category||"-"}),(0,b.jsx)("td",{className:"px-2 py-2",children:a.createdAt?new Date(a.createdAt).toLocaleString():"-"}),(0,b.jsx)("td",{className:"px-2 py-2",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(a)),alert("Copied post JSON to clipboard")},children:"Copy JSON"}),v?(0,b.jsx)(e.Button,{onClick:()=>{confirm("Delete server post?")&&fetch("/api/blogs/"+(a._id||a.id),{method:"DELETE"}).then(b=>b.ok&&t(b=>b.filter(b=>(b._id||b.id)!==(a._id||a.id))))},children:"Delete"}):null]})})]},a._id||a.id))})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold mb-2",children:"Local posts"}),(0,b.jsx)("div",{className:"space-y-2",children:a.map(c=>(0,b.jsxs)("div",{className:"p-3 bg-background rounded-md flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("img",{src:c.image||"/favicon.ico",alt:"",className:"w-16 h-12 object-cover"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-bold",children:c.title}),(0,b.jsxs)("div",{className:"text-sm text-muted",children:[c.category," Â· ",new Date(c.createdAt).toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(c)),alert("Copied post JSON to clipboard")},children:"Copy JSON"}),v?(0,b.jsx)(e.Button,{onClick:()=>{var b;return b=c.id,void(async()=>{let c="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"";try{if((await fetch(`${c}/api/blogs/${b}`,{method:"DELETE"})).ok){let c=a.filter(a=>a.id!==b);f(c),w(c);return}}catch(a){}let d=a.filter(a=>a.id!==b);f(d),w(d)})()},children:"Delete"}):null]})]},c.id))})]})]})]}),(0,b.jsxs)("div",{className:"mt-8",children:[(0,b.jsx)("h3",{className:"font-bold mb-2",children:"Publish / Import"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("button",{className:"mr-2",onClick:y,children:"Publish Local Posts to Server"}),(0,b.jsx)("span",{className:"text-sm text-muted",children:"(Attempts to POST any localStorage posts to the dashboard API)"})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("textarea",{value:q,onChange:a=>r(a.target.value),placeholder:"Paste post JSON or an array of posts here",className:"w-full p-3 rounded-md bg-background border",rows:6})}),(0,b.jsx)("div",{children:(0,b.jsx)("button",{onClick:z,children:"Import & Publish"})})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=Desktop_Projects_final-pixelate_dashboard_src_app_%28crm%29_blogs_page_tsx_9eccde7a._.js.map