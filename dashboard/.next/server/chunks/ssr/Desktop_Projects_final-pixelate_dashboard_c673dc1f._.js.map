{"version":3,"sources":["../../../../../../../../Desktop/Projects/final-pixelate/dashboard/src/components/ui/table.tsx","../../../../../../../../Desktop/Projects/final-pixelate/dashboard/src/app/%28crm%29/leads/page.tsx","../../../../../../../../Desktop/Projects/final-pixelate/dashboard/src/lib/constants.ts","../../../../../../../../Desktop/Projects/final-pixelate/dashboard/node_modules/lucide-react/src/icons/upload.ts","../../../../../../../../Desktop/Projects/final-pixelate/dashboard/node_modules/lucide-react/src/icons/trash.ts"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport type { Lead } from \"@/lib/data\";\nimport { leadStatuses } from \"@/lib/constants\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Trash, Upload } from \"lucide-react\";\n\nexport default function LeadsPage() {\n  const [leads, setLeads] = useState<Lead[]>([]);\n  const [team, setTeam] = useState<any[]>([]);\n  const [staffFilter, setStaffFilter] = useState<string>(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"\");\n  const [isDeletingAssigned, setIsDeletingAssigned] = useState(false);\n  const [deleteProgress, setDeleteProgress] = useState({\n    current: 0,\n    total: 0,\n  });\n  const [file, setFile] = useState<File | null>(null);\n  const [isImporting, setIsImporting] = useState(false);\n  const [importProgress, setImportProgress] = useState({\n    current: 0,\n    total: 0,\n  });\n\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      try {\n        // include auth header for GET so server can return role-filtered leads\n        const items = await fetchLeadsWithAuth();\n        if (mounted) setLeads(items as Lead[]);\n        // load team members for name matching\n        const t = await fetch(\"/api/team-members\");\n        const tm = await t.json();\n        if (mounted) setTeam(tm || []);\n      } catch (err) {\n        console.error(\"Failed to load leads/team\", err);\n      }\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // Helper to fetch leads securely and return an array. Handles 401 and non-array responses.\n  async function fetchLeadsWithAuth(): Promise<Lead[]> {\n    try {\n      const token = localStorage.getItem(\"auth_token\") || \"\";\n      const res = await fetch(\"/api/leads\", {\n        headers: token ? { Authorization: \"Bearer \" + token } : {},\n      });\n      if (!res.ok) {\n        console.warn(\"fetchLeadsWithAuth: server returned\", res.status);\n        // return empty array on auth failure or other errors to avoid UI crashes\n        return [];\n      }\n      const data = await res.json();\n      if (!Array.isArray(data)) return [];\n      return data as Lead[];\n    } catch (e) {\n      console.error(\"fetchLeadsWithAuth error\", e);\n      return [];\n    }\n  }\n\n  // parse uploaded XLSX/CSV and map into lead objects\n  async function handleImport() {\n    if (!file) return alert(\"Choose an Excel file first\");\n    // load xlsx dynamically (dev dependency may not be installed)\n    const XLSX = await import(\"xlsx\");\n    const buf = await file.arrayBuffer();\n    const wb = XLSX.read(buf, { type: \"array\" });\n    const sheet = wb.Sheets[wb.SheetNames[0]];\n    const rows = XLSX.utils.sheet_to_json(sheet, { defval: \"\" }) as any[];\n    // Expect columns: Name, Phone, Email, Staff Assigned\n    function levenshtein(a: string, b: string) {\n      if (a === b) return 0;\n      const al = a.length,\n        bl = b.length;\n      if (al === 0) return bl;\n      if (bl === 0) return al;\n      const matrix = Array.from({ length: al + 1 }, () =>\n        new Array(bl + 1).fill(0)\n      );\n      for (let i = 0; i <= al; i++) matrix[i][0] = i;\n      for (let j = 0; j <= bl; j++) matrix[0][j] = j;\n      for (let i = 1; i <= al; i++) {\n        for (let j = 1; j <= bl; j++) {\n          const cost = a[i - 1] === b[j - 1] ? 0 : 1;\n          matrix[i][j] = Math.min(\n            matrix[i - 1][j] + 1,\n            matrix[i][j - 1] + 1,\n            matrix[i - 1][j - 1] + cost\n          );\n        }\n      }\n      return matrix[al][bl];\n    }\n\n    const parsed = rows.map((r) => {\n      const staffName = (r[\"Staff Assigned\"] || r[\"Staff\"] || r.staff || \"\")\n        .toString()\n        .trim();\n      let matched = null;\n      if (staffName) {\n        // exact match\n        matched = team.find(\n          (t) =>\n            t.name && String(t.name).toLowerCase() === staffName.toLowerCase()\n        );\n        // contains\n        if (!matched)\n          matched = team.find(\n            (t) =>\n              t.name &&\n              String(t.name).toLowerCase().includes(staffName.toLowerCase())\n          );\n        // fuzzy\n        if (!matched) {\n          let best: any = null;\n          let bestScore = Infinity;\n          for (const t of team) {\n            if (!t.name) continue;\n            const score = levenshtein(\n              String(t.name).toLowerCase(),\n              staffName.toLowerCase()\n            );\n            if (score < bestScore) {\n              bestScore = score;\n              best = t;\n            }\n          }\n          // accept fuzzy match only when reasonably close (edit distance < 4)\n          if (best && bestScore < 4) matched = best;\n        }\n      }\n      return {\n        name: r[\"Name\"] || r[\"Full Name\"] || r.name || \"\",\n        phone: r[\"Phone\"] || r.Phone || r.phone || \"\",\n        category: r[\"Category\"] || r.Category || r.category || \"\",\n        email: r[\"Email\"] || r.email || \"\",\n        assignedTo: matched ? matched._id || matched.id : null,\n        assignedToName: matched ? matched.name : staffName || null,\n        // default imported status should be 'not called'\n        status: \"not called\",\n        project: r[\"Project\"] || r.project || \"\",\n        value: r[\"Value\"] || r.value || 0,\n        createdAt: new Date().toISOString(),\n      };\n    });\n\n    // Attempt batch upload so we can show progress. We send in small batches to\n    // update progress reliably and avoid long blocking requests.\n    // NOTE: when running on localhost we should POST to the same origin (''),\n    // and only use the production URL when running in a deployed environment.\n    const API_BASE =\n      window.location.hostname === \"localhost\" ||\n      window.location.hostname === \"127.0.0.1\"\n        ? \"\"\n        : \"https://backend.pixelatenest.com\";\n    const token = localStorage.getItem(\"auth_token\") || \"\";\n    const batchSize = 500; // increased default batch size; server accepts arrays\n    setIsImporting(true);\n    setImportProgress({ current: 0, total: parsed.length });\n\n    // helper to POST a batch with a few retries\n    async function postBatch(batch: any[], retries = 2) {\n      const headers: any = { 'Content-Type': 'application/json' };\n      if (token) headers.Authorization = 'Bearer ' + token;\n      for (let attempt = 0; attempt <= retries; attempt++) {\n        try {\n          const res = await fetch(API_BASE + '/api/leads', {\n            method: 'POST',\n            headers,\n            body: JSON.stringify(batch),\n          });\n          if (res.ok) return { ok: true, status: res.status };\n          // treat 4xx as non-retriable except 429 (rate limit)\n          if (res.status >= 400 && res.status < 500 && res.status !== 429) {\n            const text = await res.text().catch(() => String(res.status));\n            return { ok: false, status: res.status, message: text };\n          }\n          // otherwise try again after a short backoff\n        } catch (err) {\n          // network error, will retry\n        }\n        // exponential backoff\n        await new Promise(r => setTimeout(r, 500 * (attempt + 1)));\n      }\n      return { ok: false, status: 0, message: 'network or server error' };\n    }\n\n    try {\n      let failedItems: any[] = [];\n      for (let i = 0; i < parsed.length; i += batchSize) {\n        const batch = parsed.slice(i, i + batchSize);\n        const result = await postBatch(batch, 2);\n        if (!result.ok) {\n          // collect failed items to fallback later\n          failedItems.push(...batch);\n          console.warn('Batch failed:', { index: i, status: result.status, message: result.message });\n        } else {\n          // update progress only for successfully uploaded items\n          setImportProgress(p => ({ current: Math.min(parsed.length, p.current + batch.length), total: parsed.length }));\n        }\n      }\n\n      // if there are failedItems, fallback to local append for them only\n      if (failedItems.length) {\n        const existingRaw = localStorage.getItem('leads_local') || '[]';\n        const existing = JSON.parse(existingRaw);\n        const combined = [...failedItems, ...existing];\n        localStorage.setItem('leads_local', JSON.stringify(combined));\n        setLeads(prev => ([...failedItems, ...prev]));\n        setImportProgress({ current: parsed.length - failedItems.length, total: parsed.length });\n        alert(`Imported ${parsed.length - failedItems.length} items to server. ${failedItems.length} items saved locally due to upload failures.`);\n      } else {\n        // all good, refresh list from server\n        try { const list = await fetchLeadsWithAuth(); setLeads(list || []); } catch (er) { console.warn('Failed to refresh after import', er); }\n        setImportProgress({ current: parsed.length, total: parsed.length });\n        alert('Imported and saved to DB');\n      }\n    } catch (e) {\n      console.error('Unexpected import error', e);\n      alert('Import failed due to an unexpected error. Check console.');\n    } finally {\n      setIsImporting(false);\n    }\n  }\n\n  // Delete all leads: try server endpoint DELETE /api/leads, fallback to deleting per id.\n  async function deleteAllLeads() {\n    if (!confirm(\"Delete ALL leads? This cannot be undone.\")) return;\n    const API_BASE =\n      window.location.hostname === \"localhost\" ||\n      window.location.hostname === \"127.0.0.1\"\n        ? \"https://backend.pixelatenest.com\"\n        : \"\";\n    const token = localStorage.getItem(\"auth_token\") || \"\";\n    try {\n      // Attempt bulk delete endpoint first (may not exist)\n      const res = await fetch(API_BASE + \"/api/leads\", {\n        method: \"DELETE\",\n        headers: token ? { Authorization: \"Bearer \" + token } : {},\n      });\n      if (res.ok) {\n        setLeads([]);\n        localStorage.removeItem(\"leads_local\");\n        alert(\"All leads deleted (server)\");\n        return;\n      }\n    } catch (e) {\n      console.warn(\"Bulk delete not available or failed, falling back\", e);\n    }\n    try {\n      // Fallback: fetch list and delete one-by-one\n      const list = await fetchLeadsWithAuth();\n      for (const l of list) {\n        try {\n          await fetch(\"/api/leads/\" + String(l._id || l.id), {\n            method: \"DELETE\",\n            headers: token ? { Authorization: \"Bearer \" + token } : {},\n          });\n        } catch (er) {\n          /* continue deleting others */\n        }\n      }\n      setLeads([]);\n      localStorage.removeItem(\"leads_local\");\n      alert(\"All leads deleted (per-item)\");\n    } catch (e) {\n      console.error(\"Failed to delete leads\", e);\n      alert(\"Failed to delete all leads\");\n    }\n  }\n\n  // Delete all leads assigned to a specific staff member.\n  async function deleteLeadsForStaff(staffId: string | null) {\n    if (!staffId) return alert(\"Choose a staff member first\");\n    if (\n      !confirm(\n        \"Delete ALL leads assigned to this staff member? This cannot be undone.\"\n      )\n    )\n      return;\n    const API_BASE =\n      window.location.hostname === \"localhost\" ||\n      window.location.hostname === \"127.0.0.1\"\n        ? \"https://backend.pixelatenest.com\"\n        : \"\";\n    const token = localStorage.getItem(\"auth_token\") || \"\";\n    try {\n      const allLeads = await fetchLeadsWithAuth();\n      const toDelete = allLeads.filter(\n        (l) => String(l.assignedTo) === String(staffId)\n      );\n      if (!toDelete.length)\n        return alert(\"No leads assigned to this staff member\");\n      setIsDeletingAssigned(true);\n      setDeleteProgress({ current: 0, total: toDelete.length });\n      for (const l of toDelete) {\n        try {\n          const res = await fetch(\n            API_BASE + \"/api/leads/\" + String(l._id || l.id),\n            {\n              method: \"DELETE\",\n              headers: token ? { Authorization: \"Bearer \" + token } : {},\n            }\n          );\n          // If deletion was forbidden (non-admin) or failed, throw to stop and surface message\n          if (!res.ok) {\n            throw new Error(\"Server returned \" + res.status);\n          }\n        } catch (e) {\n          console.error(\"Failed to delete lead\", l, e);\n          // Continue attempting remaining deletions but record failure\n        } finally {\n          setDeleteProgress((p) => ({\n            current: Math.min(p.total, p.current + 1),\n            total: p.total,\n          }));\n        }\n      }\n      // Refresh list from server\n      try {\n        const list = await fetchLeadsWithAuth();\n        setLeads(list || []);\n      } catch (er) {}\n      alert(\n        \"Deletion of assigned leads completed (check server logs for failures)\"\n      );\n    } catch (e) {\n      console.error(\"deleteLeadsForStaff failed\", e);\n      alert(\n        \"Failed to delete assigned leads: \" +\n          (e instanceof Error ? e.message : String(e))\n      );\n    } finally {\n      setIsDeletingAssigned(false);\n      setDeleteProgress({ current: 0, total: 0 });\n      setStaffFilter(\"\");\n    }\n  }\n\n  async function deleteLead(leadId: string | number | undefined) {\n    if (!leadId) return;\n    const API_BASE =\n      window.location.hostname === \"localhost\" ||\n      window.location.hostname === \"127.0.0.1\"\n        ? \"https://backend.pixelatenest.com\"\n        : \"\";\n    try {\n      const token = localStorage.getItem(\"auth_token\") || \"\";\n      let decoded: any = null;\n      try {\n        if (token) decoded = JSON.parse(atob(token.split(\".\")[1]));\n      } catch (e) {\n        decoded = null;\n      }\n      // if user is admin, attempt permanent delete\n      if (decoded && decoded.role === \"admin\") {\n        const res = await fetch(API_BASE + \"/api/leads/\" + String(leadId), {\n          method: \"DELETE\",\n          headers: token ? { Authorization: \"Bearer \" + token } : {},\n        });\n        if (res.ok) {\n          setLeads(\n            leads.filter((l) => String(l._id || l.id) !== String(leadId))\n          );\n          alert(\"Deleted from DB\");\n          return;\n        }\n      }\n      // non-admins: mark as not deletable with a reason\n      const note =\n        prompt(\n          \"You are not allowed to permanently delete leads. Enter a short note to mark this lead as not deletable:\"\n        ) || \"\";\n      await fetch(API_BASE + \"/api/leads/\" + String(leadId), {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          ...(token ? { Authorization: \"Bearer \" + token } : {}),\n        },\n        body: JSON.stringify({ doNotDelete: true, reason: note }),\n      });\n      setLeads(\n        leads.map((l) =>\n          String(l._id || l.id) === String(leadId)\n            ? { ...l, doNotDelete: true, reason: note }\n            : l\n        )\n      );\n      alert(\"Marked as not deletable\");\n    } catch (e) {\n      console.error(\"Delete failed\", e);\n      // fallback local-only deletion\n      setLeads(leads.filter((l) => String(l._id || l.id) !== String(leadId)));\n      alert(\"Deleted locally (server may be unreachable)\");\n    }\n  }\n\n  async function updateLeadStatus(\n    leadId: string | number | undefined,\n    newStatus: (typeof leadStatuses)[number]\n  ) {\n    if (!leadId) return;\n    // prompt user for an optional reason when changing status\n    const reason =\n      prompt(\"Optional: enter a reason for this status change\") || \"\";\n    // optimistic UI update\n    setLeads((l) =>\n      l.map((x) =>\n        String(x._id || x.id) === String(leadId)\n          ? { ...x, status: newStatus, statusReason: reason }\n          : x\n      )\n    );\n    const API_BASE =\n      window.location.hostname === \"localhost\" ||\n      window.location.hostname === \"127.0.0.1\"\n        ? \"https://backend.pixelatenest.com\"\n        : \"\";\n    const token = localStorage.getItem(\"auth_token\") || \"\";\n    try {\n      const res = await fetch(API_BASE + \"/api/leads/\" + String(leadId), {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          ...(token ? { Authorization: \"Bearer \" + token } : {}),\n        },\n        body: JSON.stringify({ status: newStatus, statusReason: reason }),\n      });\n      if (!res.ok) {\n        // revert UI on failure - reload leads with auth header\n        try {\n          const list = await fetchLeadsWithAuth();\n          setLeads(list || []);\n        } catch (er) {}\n        alert(\"Failed to update status on server\");\n      }\n    } catch (e) {\n      console.error(\"Status update failed\", e);\n      // on network error, revert to server state\n      try {\n        const token = localStorage.getItem(\"auth_token\") || \"\";\n        const list = await (\n          await fetch(\"/api/leads\", {\n            headers: token ? { Authorization: \"Bearer \" + token } : {},\n          })\n        ).json();\n        setLeads(list || []);\n      } catch (er) {}\n      alert(\"Network error while updating status\");\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header>\n        <h1 className=\"text-3xl font-bold\">Leads (Table)</h1>\n        <p className=\"text-sm text-muted-foreground\">\n          Import Excel (Name, Phone, Email, Staff Assigned). Staff auto-matched\n          by name.\n        </p>\n      </header>\n\n      <div className=\"flex items-center gap-4\">\n        <input\n          type=\"file\"\n          accept=\".xlsx,.xls,.csv\"\n          onChange={(e) => setFile(e.target.files ? e.target.files[0] : null)}\n        />\n        <Button onClick={handleImport} disabled={isImporting}>\n          <Upload className=\"mr-2\" /> Import\n        </Button>\n      </div>\n\n      {/* Import progress bar */}\n      {(isImporting || importProgress.total > 0) && (\n        <div className=\"mt-3 w-full max-w-2xl\">\n          <div className=\"flex items-center justify-between mb-1\">\n            <div className=\"text-sm font-medium\">Import progress</div>\n            <div className=\"text-sm text-muted-foreground\">\n              {importProgress.current} of {importProgress.total}\n            </div>\n          </div>\n          <div className=\"w-full h-3 bg-muted rounded overflow-hidden\">\n            <div\n              role=\"progressbar\"\n              aria-valuemin={0}\n              aria-valuemax={importProgress.total || 100}\n              aria-valuenow={importProgress.current}\n              className=\"h-3 bg-primary transition-all duration-500\"\n              style={{\n                width:\n                  importProgress.total > 0\n                    ? `${Math.round(\n                        (importProgress.current / importProgress.total) * 100\n                      )}%`\n                    : \"0%\",\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex items-center gap-4\">\n        <label className=\"text-sm\">Filter by staff:</label>\n        <select\n          value={staffFilter}\n          onChange={(e) => setStaffFilter(e.target.value)}\n          className=\"px-2 py-1 rounded-md bg-background border\"\n        >\n          <option value=\"\">-- Select staff --</option>\n          {team.map((t) => (\n            <option key={String(t._id || t.id)} value={String(t._id || t.id)}>\n              {t.name}\n            </option>\n          ))}\n        </select>\n        <label className=\"text-sm\">Filter by status:</label>\n        <select\n          value={statusFilter}\n          onChange={(e) => setStatusFilter(e.target.value)}\n          className=\"px-2 py-1 rounded-md bg-background border\"\n        >\n          <option value=\"\">-- Any status --</option>\n          {leadStatuses.map((s) => (\n            <option key={s} value={s}>\n              {s}\n            </option>\n          ))}\n        </select>\n        <Button\n          variant=\"destructive\"\n          onClick={() => deleteLeadsForStaff(staffFilter)}\n          disabled={!staffFilter || isDeletingAssigned}\n        >\n          Delete leads for selected staff\n        </Button>\n        {isDeletingAssigned ? (\n          <div className=\"text-sm\">\n            Deleting {deleteProgress.current}/{deleteProgress.total}...\n          </div>\n        ) : null}\n      </div>\n\n      <Table>\n        <TableHeader>\n          <TableRow>\n            <TableHead>Name</TableHead>\n            <TableHead>Category</TableHead>\n            <TableHead>Phone</TableHead>\n            <TableHead>Email</TableHead>\n            <TableHead>Assigned</TableHead>\n            <TableHead>Status</TableHead>\n            <TableHead>Status Reason</TableHead>\n            <TableHead>Actions</TableHead>\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {leads\n            .filter((l) => {\n              // apply staff filter first\n              if (staffFilter) {\n                if (\n                  String(l.assignedTo || l.assignedToName) !==\n                  String(staffFilter)\n                )\n                  return false;\n              }\n              // apply status filter\n              if (statusFilter) {\n                if (String(l.status || \"\") !== String(statusFilter))\n                  return false;\n              }\n              return true;\n            })\n            .map((lead) => (\n              <TableRow key={String(lead._id || lead.id)}>\n                <TableCell>{lead.name}</TableCell>\n                <TableCell>{(lead as any).category || \"-\"}</TableCell>\n                <TableCell>{lead.phone}</TableCell>\n                <TableCell>{lead.email}</TableCell>\n                <TableCell>\n                  {lead.assignedToName || lead.assignedTo || \"-\"}\n                </TableCell>\n                <TableCell>\n                  <select\n                    value={lead.status || leadStatuses[0]}\n                    onChange={(e) =>\n                      updateLeadStatus(\n                        lead._id || lead.id,\n                        e.target.value as any\n                      )\n                    }\n                    className=\"px-2 py-1 rounded-md bg-background border\"\n                  >\n                    {leadStatuses.map((s) => (\n                      <option key={s} value={s}>\n                        {s}\n                      </option>\n                    ))}\n                  </select>\n                </TableCell>\n                <TableCell>{(lead as any).statusReason || \"-\"}</TableCell>\n                <TableCell>\n                  {lead.doNotDelete ? (\n                    <div className=\"text-sm text-muted-foreground\">\n                      Not deletable\n                    </div>\n                  ) : null}\n                  <Button\n                    variant=\"destructive\"\n                    size=\"sm\"\n                    onClick={() => deleteLead(lead._id || lead.id)}\n                  >\n                    <Trash />\n                  </Button>\n                </TableCell>\n              </TableRow>\n            ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","// Client-safe runtime constants. Keep this file free of any server-only imports.\n// include 'not called' as default for new imports\nexport const leadStatuses = ['not called', 'called', 'not interested', 'meeting booked', 'interested', 'call back later', 'other'] as const;\n\nexport type LeadStatus = (typeof leadStatuses)[number];\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],\n  ['polyline', { points: '17 8 12 3 7 8', key: 't8dd8p' }],\n  ['line', { x1: '12', x2: '12', y1: '3', y2: '15', key: 'widbto' }],\n];\n\n/**\n * @component @name Upload\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTV2NGEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnYtNCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxNyA4IDEyIDMgNyA4IiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjEyIiB5MT0iMyIgeTI9IjE1IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/upload\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Upload = createLucideIcon('Upload', __iconNode);\n\nexport default Upload;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6', key: '4alrt4' }],\n  ['path', { d: 'M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2', key: 'v07s0e' }],\n];\n\n/**\n * @component @name Trash\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyA2aDE4IiAvPgogIDxwYXRoIGQ9Ik0xOSA2djE0YzAgMS0xIDItMiAySDdjLTEgMC0yLTEtMi0yVjYiIC8+CiAgPHBhdGggZD0iTTggNlY0YzAtMSAxLTIgMi0yaDRjMSAwIDIgMSAyIDJ2MiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/trash\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Trash = createLucideIcon('Trash', __iconNode);\n\nexport default Trash;\n"],"names":[],"mappings":"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","ignoreList":[3,4]}