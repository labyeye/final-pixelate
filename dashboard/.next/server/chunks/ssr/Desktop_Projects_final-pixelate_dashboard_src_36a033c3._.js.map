{"version":3,"sources":["../../../../../../../../Desktop/Projects/final-pixelate/dashboard/src/components/ui/input.tsx","../../../../../../../../Desktop/Projects/final-pixelate/dashboard/src/app/%28crm%29/profile/page.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-14 w-full rounded-none border-2 border-foreground bg-background px-4 py-3 text-lg ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","\"use client\";\n\nimport { useEffect, useState } from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\n\nexport default function ProfilePage() {\n  const [profile, setProfile] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [pwSaving, setPwSaving] = useState(false);\n  const [newPassword, setNewPassword] = useState('');\n  const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      setLoading(true);\n      try {\n        const token = localStorage.getItem('auth_token') || ''\n        const res = await fetch('/api/me', { headers: token ? { Authorization: 'Bearer ' + token } : {} });\n        if (res.ok) {\n          const data = await res.json();\n          setProfile(data);\n        }\n      } catch (e) { console.error(e) }\n      setLoading(false);\n    })();\n  }, []);\n\n  async function saveProfile() {\n    if (!profile) return;\n    setSaving(true);\n    try {\n      const token = localStorage.getItem('auth_token') || ''\n      const res = await fetch('/api/me', { method: 'PATCH', headers: { 'Content-Type': 'application/json', ...(token ? { Authorization: 'Bearer ' + token } : {}) }, body: JSON.stringify({ name: profile.name, email: profile.email, jobRole: profile.jobRole, avatar: profile.avatar || null }) });\n      if (res.ok) {\n        const updated = await res.json();\n        setProfile(updated);\n        alert('Profile updated');\n      } else {\n        const err = await res.json(); alert('Failed: ' + (err.error || res.status))\n      }\n    } catch (e) { console.error(e); alert('Save failed') }\n    setSaving(false);\n  }\n\n  async function changePassword() {\n    if (!newPassword) return alert('Enter new password');\n    setPwSaving(true);\n    try {\n      const token = localStorage.getItem('auth_token') || ''\n      const res = await fetch('/api/me', { method: 'POST', headers: { 'Content-Type': 'application/json', ...(token ? { Authorization: 'Bearer ' + token } : {}) }, body: JSON.stringify({ action: 'change-password', newPassword }) });\n      if (res.ok) {\n        alert('Password changed');\n        setNewPassword('');\n      } else {\n        const err = await res.json(); alert('Failed: ' + (err.error || res.status))\n      }\n    } catch (e) { console.error(e); alert('Change failed') }\n    setPwSaving(false);\n  }\n\n  if (loading) return <div>Loading...</div>\n  if (!profile) return <div>No profile loaded</div>\n\n  return (\n    <div className=\"space-y-6\">\n      <h1 className=\"text-2xl font-bold\">Profile</h1>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm\">Full name</label>\n          <Input value={profile.name || ''} onChange={e => setProfile((p: any) => ({ ...p, name: e.target.value }))} />\n        </div>\n        <div>\n          <label className=\"block text-sm\">Email</label>\n          <Input value={profile.email || ''} onChange={e => setProfile((p: any) => ({ ...p, email: e.target.value }))} />\n        </div>\n        <div>\n          <label className=\"block text-sm\">Job role</label>\n          <Input value={profile.jobRole || ''} onChange={e => setProfile((p: any) => ({ ...p, jobRole: e.target.value }))} />\n        </div>\n      </div>\n      <div>\n        <Button onClick={saveProfile} disabled={saving}>{saving ? 'Saving...' : 'Save profile'}</Button>\n      </div>\n\n      <hr />\n\n      <h2 className=\"text-xl font-bold\">Change password</h2>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm\">Upload avatar</label>\n          <input type=\"file\" accept=\"image/*\" onChange={async (e) => {\n            const f = e.currentTarget.files && e.currentTarget.files[0];\n            if (!f) return;\n            const reader = new FileReader();\n            reader.onload = () => {\n              const result = reader.result as string | null;\n              if (result) {\n                setAvatarPreview(result);\n                setProfile((p: any) => ({ ...p, avatar: result }));\n              }\n            };\n            reader.readAsDataURL(f);\n          }} />\n          {avatarPreview || profile.avatar ? (\n            <img src={avatarPreview || profile.avatar} alt=\"avatar\" className=\"w-24 h-24 rounded-md mt-2 object-cover\" />\n          ) : null}\n        </div>\n        <div>\n          <label className=\"block text-sm\">New password (enter only new password)</label>\n          <Input type=\"password\" value={newPassword} onChange={e => setNewPassword(e.target.value)} />\n        </div>\n      </div>\n      <div>\n        <Button variant=\"secondary\" onClick={changePassword} disabled={pwSaving}>{pwSaving ? 'Updating...' : 'Change password'}</Button>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}