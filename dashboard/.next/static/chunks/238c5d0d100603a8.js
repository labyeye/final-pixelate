(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46492,e=>{"use strict";var t=e.i(34371),s=e.i(10913),a=e.i(43509),l=e.i(63951);function i(){let[e,i]=(0,s.useState)([]),[o,r]=(0,s.useState)(""),[n,c]=(0,s.useState)(""),[d,h]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[x,u]=(0,s.useState)(""),[b,f]=(0,s.useState)(""),[g,j]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=localStorage.getItem("pn_posts");if(e)try{i(JSON.parse(e))}catch(e){}(async()=>{try{let e=await fetch("/api/blogs");if(e.ok){let t=await e.json();j(Array.isArray(t)?t:[])}}catch(e){}})()},[]);let{user:N}=(0,a.useAuth)(),v=N?.role==="admin";function y(e){localStorage.setItem("pn_posts",JSON.stringify(e))}async function w(){if(!o)return alert("title required");let t={id:Date.now(),title:o,category:n,excerpt:d,content:m,image:x,createdAt:new Date().toISOString()},s="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"";try{let a=await fetch(s+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){let s=await a.json(),l=[{...t,...s},...e];i(l),y(l),r(""),c(""),h(""),p(""),u("");return}}catch(e){}let a=[t,...e];i(a),y(a),r(""),c(""),h(""),p(""),u(""),alert("Saved locally (server unreachable).")}async function S(){let t=localStorage.getItem("pn_posts");if(!t)return alert("No local posts found");let s=[];try{s=JSON.parse(t)}catch(e){return alert("Invalid local posts JSON")}if(!s.length)return alert("No local posts to publish");let a="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"",l=[...e];for(let e of s)try{let t=await fetch(a+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let s=await t.json();l.unshift({...e,...s})}else l.unshift(e)}catch(t){l.unshift(e)}i(l),y(l),alert("Publish attempt finished. Check public site or API to confirm.")}async function C(){let t;if(!b)return alert("Paste JSON into the import box first");try{t=JSON.parse(b)}catch(e){return alert("Invalid JSON")}let s=Array.isArray(t)?t:[t],a="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"",l=[...e];for(let e of s)try{let t=await fetch(a+"/api/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let s=await t.json();l.unshift({...e,...s})}else l.unshift(e)}catch(t){l.unshift(e)}i(l),y(l),f(""),alert("Import finished. Check public site or API to confirm.")}return(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Blogs Management"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("input",{value:o,onChange:e=>r(e.target.value),placeholder:"Title",className:"w-full p-3 rounded-md bg-background border"})}),(0,t.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[(0,t.jsx)("input",{value:n,onChange:e=>c(e.target.value),placeholder:"Category",className:"p-3 rounded-md bg-background border"}),(0,t.jsx)("input",{type:"file",onChange:function(e){let t=e.target.files&&e.target.files[0];if(!t)return;let s=new FileReader;s.onload=()=>u(String(s.result)),s.readAsDataURL(t)},className:"p-3 rounded-md bg-background border"})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("textarea",{value:d,onChange:e=>h(e.target.value),placeholder:"Excerpt",className:"w-full p-3 rounded-md bg-background border",rows:3})}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),placeholder:"Content (HTML allowed)",className:"w-full p-3 rounded-md bg-background border",rows:8})}),(0,t.jsx)("div",{className:"flex gap-3",children:(0,t.jsx)(l.Button,{onClick:w,children:"Add Post"})})]}),(0,t.jsxs)("aside",{className:"p-4 bg-muted rounded-md",children:[(0,t.jsx)("h3",{className:"font-bold mb-2",children:"Preview"}),x?(0,t.jsx)("img",{src:x,alt:"preview",className:"w-full mb-2"}):(0,t.jsx)("div",{className:"mb-2 text-sm text-muted",children:"No image"}),(0,t.jsx)("div",{className:"font-bold",children:o||"Title goes here"}),(0,t.jsx)("div",{className:"text-sm text-muted mb-2",children:n}),(0,t.jsx)("div",{className:"text-sm",children:d})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h3",{className:"font-bold mb-2",children:"Existing Posts"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold mb-2",children:"Server posts"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-2 py-1",children:"Title"}),(0,t.jsx)("th",{className:"px-2 py-1",children:"Category"}),(0,t.jsx)("th",{className:"px-2 py-1",children:"Created"}),(0,t.jsx)("th",{className:"px-2 py-1",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:g.map(e=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"px-2 py-2",children:e.title}),(0,t.jsx)("td",{className:"px-2 py-2",children:e.category||"-"}),(0,t.jsx)("td",{className:"px-2 py-2",children:e.createdAt?new Date(e.createdAt).toLocaleString():"-"}),(0,t.jsx)("td",{className:"px-2 py-2",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.Button,{onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(e)),alert("Copied post JSON to clipboard")},children:"Copy JSON"}),v?(0,t.jsx)(l.Button,{onClick:()=>{confirm("Delete server post?")&&fetch("/api/blogs/"+(e._id||e.id),{method:"DELETE"}).then(t=>t.ok&&j(t=>t.filter(t=>(t._id||t.id)!==(e._id||e.id))))},children:"Delete"}):null]})})]},e._id||e.id))})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold mb-2",children:"Local posts"}),(0,t.jsx)("div",{className:"space-y-2",children:e.map(s=>(0,t.jsxs)("div",{className:"p-3 bg-background rounded-md flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:s.image||"/favicon.ico",alt:"",className:"w-16 h-12 object-cover"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold",children:s.title}),(0,t.jsxs)("div",{className:"text-sm text-muted",children:[s.category," Â· ",new Date(s.createdAt).toLocaleString()]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.Button,{onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(s)),alert("Copied post JSON to clipboard")},children:"Copy JSON"}),v?(0,t.jsx)(l.Button,{onClick:()=>{var t;return t=s.id,void(async()=>{let s="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"https://backend.pixelatenest.com":"";try{if((await fetch(`${s}/api/blogs/${t}`,{method:"DELETE"})).ok){let s=e.filter(e=>e.id!==t);i(s),y(s);return}}catch(e){}let a=e.filter(e=>e.id!==t);i(a),y(a)})()},children:"Delete"}):null]})]},s.id))})]})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h3",{className:"font-bold mb-2",children:"Publish / Import"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("button",{className:"mr-2",onClick:S,children:"Publish Local Posts to Server"}),(0,t.jsx)("span",{className:"text-sm text-muted",children:"(Attempts to POST any localStorage posts to the dashboard API)"})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),placeholder:"Paste post JSON or an array of posts here",className:"w-full p-3 rounded-md bg-background border",rows:6})}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:C,children:"Import & Publish"})})]})]})}e.s(["default",()=>i])}]);