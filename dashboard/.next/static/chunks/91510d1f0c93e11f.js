(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32473,e=>{"use strict";var a=e.i(34371),t=e.i(10913),l=e.i(2507);let r=t.forwardRef(({className:e,type:t,...r},s)=>(0,a.jsx)("input",{type:t,className:(0,l.cn)("flex h-14 w-full rounded-none border-2 border-foreground bg-background px-4 py-3 text-lg ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));r.displayName="Input",e.s(["Input",()=>r])},15527,e=>{"use strict";var a=e.i(34371),t=e.i(10913),l=e.i(32473),r=e.i(63951);function s(){let[e,s]=(0,t.useState)(null),[i,o]=(0,t.useState)(!1),[n,d]=(0,t.useState)(!1),[c,u]=(0,t.useState)(!1),[h,g]=(0,t.useState)(""),[f,m]=(0,t.useState)(null);async function p(){if(e){d(!0);try{let a=localStorage.getItem("auth_token")||"",t=await fetch("/api/me",{method:"PATCH",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer "+a}:{}},body:JSON.stringify({name:e.name,email:e.email,jobRole:e.jobRole,avatar:e.avatar||null})});if(t.ok){let e=await t.json();s(e),alert("Profile updated")}else{let e=await t.json();alert("Failed: "+(e.error||t.status))}}catch(e){console.error(e),alert("Save failed")}d(!1)}}async function x(){if(!h)return alert("Enter new password");u(!0);try{let e=localStorage.getItem("auth_token")||"",a=await fetch("/api/me",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:"Bearer "+e}:{}},body:JSON.stringify({action:"change-password",newPassword:h})});if(a.ok)alert("Password changed"),g("");else{let e=await a.json();alert("Failed: "+(e.error||a.status))}}catch(e){console.error(e),alert("Change failed")}u(!1)}return((0,t.useEffect)(()=>{(async()=>{o(!0);try{let e=localStorage.getItem("auth_token")||"",a=await fetch("/api/me",{headers:e?{Authorization:"Bearer "+e}:{}});if(a.ok){let e=await a.json();s(e)}}catch(e){console.error(e)}o(!1)})()},[]),i)?(0,a.jsx)("div",{children:"Loading..."}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Profile"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Full name"}),(0,a.jsx)(l.Input,{value:e.name||"",onChange:e=>s(a=>({...a,name:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Email"}),(0,a.jsx)(l.Input,{value:e.email||"",onChange:e=>s(a=>({...a,email:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Job role"}),(0,a.jsx)(l.Input,{value:e.jobRole||"",onChange:e=>s(a=>({...a,jobRole:e.target.value}))})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)(r.Button,{onClick:p,disabled:n,children:n?"Saving...":"Save profile"})}),(0,a.jsx)("hr",{}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Change password"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Upload avatar"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{let a=e.currentTarget.files&&e.currentTarget.files[0];if(!a)return;let t=new FileReader;t.onload=()=>{let e=t.result;e&&(m(e),s(a=>({...a,avatar:e})))},t.readAsDataURL(a)}}),f||e.avatar?(0,a.jsx)("img",{src:f||e.avatar,alt:"avatar",className:"w-24 h-24 rounded-md mt-2 object-cover"}):null]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"New password (enter only new password)"}),(0,a.jsx)(l.Input,{type:"password",value:h,onChange:e=>g(e.target.value)})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)(r.Button,{variant:"secondary",onClick:x,disabled:c,children:c?"Updating...":"Change password"})})]}):(0,a.jsx)("div",{children:"No profile loaded"})}e.s(["default",()=>s])}]);